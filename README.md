modified from [vllm/model_executor/models/qwen3_next.py](https://github.com/vllm-project/vllm/blob/v0.10.2/vllm/model_executor/models/qwen3_next.py)
